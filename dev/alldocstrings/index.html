<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · LyoPronto.jl</title><meta name="title" content="Reference · LyoPronto.jl"/><meta property="og:title" content="Reference · LyoPronto.jl"/><meta property="twitter:title" content="Reference · LyoPronto.jl"/><meta name="description" content="Documentation for LyoPronto.jl."/><meta property="og:description" content="Documentation for LyoPronto.jl."/><meta property="twitter:description" content="Documentation for LyoPronto.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LyoPronto.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../generated/fitting_mannitol/">Example, conventional lyo</a></li><li><a class="tocitem" href="../generated/utilities/">Other tools</a></li><li><a class="tocitem" href="../generated/all_recipes/">Plot recipes</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Parameter-Fitting"><span>Parameter Fitting</span></a></li><li><a class="tocitem" href="#Plot-Recipes"><span>Plot Recipes</span></a></li><li><a class="tocitem" href="#Vial-Dimensions"><span>Vial Dimensions</span></a></li><li><a class="tocitem" href="#Model-Equations"><span>Model Equations</span></a></li><li><a class="tocitem" href="#Physical-Properties"><span>Physical Properties</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/LyoHUB/LyoPronto.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/LyoHUB/LyoPronto.jl/blob/main/docs/src/alldocstrings.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="All-Docstrings"><a class="docs-heading-anchor" href="#All-Docstrings">All Docstrings</a><a id="All-Docstrings-1"></a><a class="docs-heading-anchor-permalink" href="#All-Docstrings" title="Permalink"></a></h1><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.PrimaryDryFit" href="#LyoPronto.PrimaryDryFit"><code>LyoPronto.PrimaryDryFit</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>PrimaryDryFit: a type for indicating how experimental data should be fit.</p><p>Provided constructors:</p><pre><code class="language-julia hljs">PrimaryDryFit(t, Tfs, Tvws, t_end)
PrimaryDryFit(t, Tfs; Tvws=missing, t_end=missing) = PrimaryDryFit(t, Tfs, Tvws, t_end)</code></pre><p>Note that <code>Tvws</code> and <code>t_end</code> in the second constructors are keyword arguments, so either or both can be left out.</p><p>The use of this struct is determined in large part by the implementation of  <a href="#LyoPronto.obj_expT-Tuple{ODESolution, PrimaryDryFit}"><code>LyoPronto.obj_expT</code></a> and <a href="#LyoPronto.err_expT!-Tuple{Any, ODESolution, Any}"><code>LyoPronto.err_expT!</code></a>. If a given field is not  available, it will be set to <code>missing</code> and things should basically work. At least <code>t</code> and  <code>Tfs</code> are expected to always be provided.</p><p>In the end, <code>Tfs</code> and <code>Tvws</code> are each stored as a tuple of vectors, but the constructors try to  be flexible about allowing a single vector to be passed in place of a tuple of vectors.</p><p>The fields <code>Tf_iend</code> and <code>Tvw_iend</code> default to <code>[length(Tf) for Tf in Tfs]</code> and <code>[length(Tvw) for Tvw in Tvws]</code>,  respectively, with one value for each temperature series;  they are used to dictate if a given temperature series should be truncated sooner than the full length in the fitting procedure. This implies that all the temperature series correspond to the same time points, then stop having measured values after a different number of measurements. If a single value is given for <code>Tvws</code>, then it is taken to be an endpoint, and <code>Tvw_iend</code> will be <code>missing</code>.</p><p><code>t_end</code> indicates an end of drying, particularly if taken from other measurements (e.g. from Pirani-CM convergence). If set to <code>missing</code>, it is ignored in the objective function. If set to a tuple of two times, then in the objective function any time  in that window is not penalized; outside that window, squared error takes over, as for the  single time case.</p><p>Principal Cases:</p><ul><li>Conventional: provide only <code>t, Tfs</code></li><li>Conventional with Pirani ending: provide <code>t, Tfs; t_end=...</code></li><li>RF with measured vial wall: provide <code>t, Tfs; Tvws=...</code>, </li><li>RF, matching model Tvw to experimental Tf[end] without measured vial wall: provide <code>t, Tfs, Tvws=...</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/structs.jl#L194-L232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.RampedVariable" href="#LyoPronto.RampedVariable"><code>LyoPronto.RampedVariable</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A convenience type for computing temperatures, pressures, etc. with multiple setpoints in sequence, and linear interpolation according to a fixed ramp rate between set points</p><p>Three main constructors are available: For a non-varying value, call with one argument:</p><pre><code class="language-julia hljs">RampedVariable(constant_setpt)</code></pre><p>For one ramp from initial value to set point with indefinite hold, call with two arguments:</p><pre><code class="language-julia hljs">RampedVariable(setpts, ramprate)</code></pre><p>And for multiple setpoints, call with three arguments:</p><pre><code class="language-julia hljs">RampedVariable(setpts, ramprates, holds)</code></pre><p>With three arguments, <code>setpts</code>, <code>ramprates</code>, and <code>holds</code> should all be vectors, with lengths N+1, N, N-1 respectively.</p><p>The resulting RampedVariable <code>rv = RampedVariable(...)</code> can be called as <code>rv(x)</code> at any (dimensionally consistent) value of x,  and will return the value at that time point along the ramp process.</p><p>A plot recipe is also provided for this type, e.g. <code>plot(rv; tmax=10u&quot;hr&quot;)</code> where <code>tmax</code> indicates where to stop drawing the last setpoint hold.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/structs.jl#L28-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.RpFormFit" href="#LyoPronto.RpFormFit"><code>LyoPronto.RpFormFit</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A convenience type for dealing with the common functional form given to Rp and Kv.</p><p>An object <code>Rp = RpFormFit(A, B, C)</code> can be called as <code>Rp(x)</code>, which simply computes <code>A + B*x/(1 + C*x)</code>. Likewise, <code>Kv = RpFormFit(Kc, Kp, Kd)</code> can be called as <code>Kv(p)</code> to get <code>Kc + Kp*p/(1 + Kd*p)</code>.</p><p>Be careful to pass dimensionally consistent values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/structs.jl#L7-L14">source</a></section></article><h2 id="Parameter-Fitting"><a class="docs-heading-anchor" href="#Parameter-Fitting">Parameter Fitting</a><a id="Parameter-Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Fitting" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.KBB_transform_basic-Tuple{Any, Any, Any}" href="#LyoPronto.KBB_transform_basic-Tuple{Any, Any, Any}"><code>LyoPronto.KBB_transform_basic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KBB_transform_basic(Kvwfg, Bfg, Bvwg)
</code></pre><p>Construct a typical transform for fitting Kvwf, Bf, and Bvw (as for a microwave cycle).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L35-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.KBB_transform_bounded-Tuple{Any, Any, Any}" href="#LyoPronto.KBB_transform_bounded-Tuple{Any, Any, Any}"><code>LyoPronto.KBB_transform_bounded</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KBB_transform_bounded(
    Kvwfg,
    Bfg,
    Bvwg;
    Kvwf_scalefac,
    Bf_scalefac,
    Bvw_scalefac
)
</code></pre><p>Construct a bounded transform for fitting Kvwf, Bf, and Bvw (as for a microwave cycle).</p><p><code>Kvwf_scalefac</code>, <code>Bf_scalefac</code>, and <code>Bvw_scalefac</code> are used to provide upper and lower  bounds on the fitted parameter, as <code>(Kvwfg/Kvwf_scalefac, Kvwfg*Kvwf_scalefac)</code>, etc. This is enforced with a logistic transform scaled and shifted appropriately.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L46-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.KRp_transform_basic-NTuple{4, Any}" href="#LyoPronto.KRp_transform_basic-NTuple{4, Any}"><code>LyoPronto.KRp_transform_basic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KRp_transform_basic(Kshfg, R0g, A1g, A2g)
</code></pre><p>Construct a typical transform for fitting both Kshf and Rp.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.K_transform_basic-Tuple{Any}" href="#LyoPronto.K_transform_basic-Tuple{Any}"><code>LyoPronto.K_transform_basic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">K_transform_basic(Kshfg)
</code></pre><p>Construct a typical transform for fitting Kshf (a.k.a. Kv).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.Rp_transform_basic-Tuple{Any, Any, Any}" href="#LyoPronto.Rp_transform_basic-Tuple{Any, Any, Any}"><code>LyoPronto.Rp_transform_basic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Rp_transform_basic(R0g, A1g, A2g)
</code></pre><p>Construct a typical transform for fitting Rp.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.err_expT!-Tuple{Any, ODESolution, Any}" href="#LyoPronto.err_expT!-Tuple{Any, ODESolution, Any}"><code>LyoPronto.err_expT!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">err_expT!(errs, sol, pdfit; tweight, verbose)
</code></pre><p>Evaluate the error between model solution <code>sol</code> and experimental data in <code>pdfit</code>.</p><p>The in-place version <code>err_expT!</code> fills the <code>errs</code> vector with the errors, while the non-in-place version <code>err_expT</code> returns a new vector of errors. In-place <code>err_expT!</code> thus doesn&#39;t allocate, but requires <code>errs</code> to have length <code>num_errs(pdfit)</code>.</p><p>In contrast to <code>obj_expT()</code>, which sums all the squared residuals, this function fills the passed array <code>errs</code> with each separate residual, which is suited for least squares algorithms.</p><ul><li><code>errs</code> is a vector of length <code>num_errs(pdfit)</code>, which this function fills with the errors.</li></ul><p>-<code>sol</code> is a solution to an appropriate model; see <a href="#LyoPronto.gen_sol_pd-NTuple{4, Any}"><code>gen_sol_pd</code></a> for a helper function.</p><ul><li><code>pdfit</code> is an instance of <code>PrimaryDryFit</code>, which contains some information about what to compare.</li><li><code>tweight = 1</code> gives the weighting (in K^2/hr^2) of the total drying time in the objective, as compared to the temperature error.</li></ul><p>Each time series, plus the end time, is given equal weight by dividing by its length; error is given in K (but <code>ustrip</code>ped).</p><p>Note that if <code>pdfit</code> has vial wall temperatures (i.e. <code>ismissing(pdfit.Tvws) == false</code>), the third-index variable in <code>sol</code> is assumed to be temperature, as is true for solutions with <a href="#LyoPronto.ParamObjRF"><code>ParamObjRF</code></a>.</p><p>If there are multiple series of <code>Tf</code> in <code>pdfit</code>, error is computed for each separately; likewise for <code>Tvw</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L321-L325">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.err_expT-Tuple{Any, Any}" href="#LyoPronto.err_expT-Tuple{Any, Any}"><code>LyoPronto.err_expT</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">err_expT(sol, pdfit; tweight, verbose)
</code></pre><p>Evaluate the error between model solution <code>sol</code> and experimental data in <code>pdfit</code>.</p><p>The in-place version <code>err_expT!</code> fills the <code>errs</code> vector with the errors, while the non-in-place version <code>err_expT</code> returns a new vector of errors. In-place <code>err_expT!</code> thus doesn&#39;t allocate, but requires <code>errs</code> to have length <code>num_errs(pdfit)</code>.</p><p>In contrast to <code>obj_expT()</code>, which sums all the squared residuals, this function fills the passed array <code>errs</code> with each separate residual, which is suited for least squares algorithms.</p><ul><li><code>errs</code> is a vector of length <code>num_errs(pdfit)</code>, which this function fills with the errors.</li></ul><p>-<code>sol</code> is a solution to an appropriate model; see <a href="#LyoPronto.gen_sol_pd-NTuple{4, Any}"><code>gen_sol_pd</code></a> for a helper function.</p><ul><li><code>pdfit</code> is an instance of <code>PrimaryDryFit</code>, which contains some information about what to compare.</li><li><code>tweight = 1</code> gives the weighting (in K^2/hr^2) of the total drying time in the objective, as compared to the temperature error.</li></ul><p>Each time series, plus the end time, is given equal weight by dividing by its length; error is given in K (but <code>ustrip</code>ped).</p><p>Note that if <code>pdfit</code> has vial wall temperatures (i.e. <code>ismissing(pdfit.Tvws) == false</code>), the third-index variable in <code>sol</code> is assumed to be temperature, as is true for solutions with <a href="#LyoPronto.ParamObjRF"><code>ParamObjRF</code></a>.</p><p>If there are multiple series of <code>Tf</code> in <code>pdfit</code>, error is computed for each separately; likewise for <code>Tvw</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L427-L431">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.gen_nsol_pd-NTuple{4, Any}" href="#LyoPronto.gen_nsol_pd-NTuple{4, Any}"><code>LyoPronto.gen_nsol_pd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gen_nsol_pd(fitlog, tr, pos, fitdats; badprms, kwargs...)
</code></pre><p>Generate multiple solutions at once.</p><p>If the transformation <code>tr</code> makes something (e.g. NamedTuple) with properties <code>separate</code> and  <code>shared</code>, then one each of <code>separate</code> is combined with <code>shared</code>, then they are matched up with each element of <code>pos</code> and <code>fitdats</code>. If <code>pos</code> is a single object, it is repeated. Further, if <code>tr</code> also has a field <code>sep_inds</code>, then those indices are used to map <code>separate</code>  to the sets of <code>pos</code> and <code>fitdats</code>. This is useful for when e.g. 2 sets of <code>separate</code> parameters  are to be applied across 5 different experiments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L102-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.gen_sol_pd-NTuple{4, Any}" href="#LyoPronto.gen_sol_pd-NTuple{4, Any}"><code>LyoPronto.gen_sol_pd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gen_sol_pd(fitlog, tr, po, fitdat; badprms, kwargs...)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.gen_sol_pd-Tuple{Any, Any, Any}" href="#LyoPronto.gen_sol_pd-Tuple{Any, Any, Any}"><code>LyoPronto.gen_sol_pd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gen_sol_pd(fitlog, tr, po; saveat, badprms, kwargs...)
</code></pre><p>Simulate primary drying, given a vector of parameter guesses, a mapping <code>tr</code> from <code>fitlog</code> to named coefficients, and other parameters in <code>po</code>.</p><p>The equations used are determined by the type of <code>po</code>, which (with the magic of dispatch) is used to set up an ODE system.</p><p><code>tr</code> should be a <code>TransformTuple</code> object, from TransformVariables, which maps e.g. a vector of 3 real numbers to a NamedTuple with <code>R0, A1, A2</code> as keys and appropriate Unitful dimensions on the values. This small function runs </p><pre><code class="language-julia hljs">fitprm = transform(tr, fitlog)
new_params = setproperties(po, fitprm)
prob = ODEProblem(new_params; tspan=(0.0, 1000.0))
sol = solve(prob, Rodas4(autodiff=AutoForwardDiff(chunksize=2)); saveat, kwargs...)</code></pre><p>which is wrapped to avoid code duplication.</p><p>So, to choose which parameters to fitting, all that is necessary is to provide an appropriate transform <code>tr</code> and add a method of <code>setproperties</code> for the desired parameters. Therefore this function can be used for both K-Rp fitting, or just Rp, or just a subset of the 3 Rp coefficients.</p><p>If given, <code>fitdat</code> is used to set <code>saveat</code> for the ODE solution.</p><p>Other <code>kwargs</code> are passed directly (as is) to the ODE <code>solve</code> call.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L61-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.nls_pd!-Tuple{Any, Any, Any}" href="#LyoPronto.nls_pd!-Tuple{Any, Any, Any}"><code>LyoPronto.nls_pd!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nls_pd!(errs, fitlog, tpf; tweight, verbose)
</code></pre><p>Calculate the errors for fitting parameters to primary drying data. This directly calls <a href="#LyoPronto.gen_sol_pd-NTuple{4, Any}"><code>gen_sol_pd</code></a>, then <a href="#LyoPronto.err_expT!-Tuple{Any, ODESolution, Any}"><code>err_expT!</code></a>, so see those docstrings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L165-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.nls_pd-Tuple{Any, Any}" href="#LyoPronto.nls_pd-Tuple{Any, Any}"><code>LyoPronto.nls_pd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nls_pd(fitlog, tpf; tweight, verbose)
</code></pre><p>Calculate the errors for fitting parameters to primary drying data. This directly calls <a href="#LyoPronto.gen_sol_pd-NTuple{4, Any}"><code>gen_sol_pd</code></a>, then <a href="#LyoPronto.err_expT-Tuple{Any, Any}"><code>err_expT</code></a>, so see those docstrings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L175-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.num_errs-Tuple{Any}" href="#LyoPronto.num_errs-Tuple{Any}"><code>LyoPronto.num_errs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">num_errs(pdfit)
</code></pre><p>Compute the number of data points available in <code>pdfit</code> for comparison to model solution.</p><p>This is useful for caching a residual vector for least-squares fitting, e.g. with <a href="#LyoPronto.err_expT!-Tuple{Any, ODESolution, Any}"><code>err_expT!</code></a> and <a href="#LyoPronto.nls_pd!-Tuple{Any, Any, Any}"><code>nls_pd!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L288-L294">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.obj_expT-Tuple{ODESolution, PrimaryDryFit}" href="#LyoPronto.obj_expT-Tuple{ODESolution, PrimaryDryFit}"><code>LyoPronto.obj_expT</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obj_expT(sol, pdfit; tweight, verbose, Tvw_weight)
</code></pre><p>Evaluate an objective function which compares model solution computed by <code>sol</code> to experimental data in <code>pdfit</code>.</p><ul><li><code>sol</code> is a solution to an appropriate model; see <a href="#LyoPronto.gen_sol_pd-NTuple{4, Any}"><code>gen_sol_pd</code></a> for a helper.</li><li><code>pdfit</code> is an instance of <code>PrimaryDryFit</code>, which contains some information about what to compare.</li><li><code>tweight = 1</code> gives the weighting (in K^2/hr^2) of the total drying time in the objective, as compared to the temperature error.</li><li><code>Tvw_weight = 1</code> gives the weighting of Tvw in the objective, as compared to Tf.</li></ul><p>Note that if <code>pdfit</code> has vial wall temperatures (i.e. <code>ismissing(pdfit.Tvws) == false</code>), the third-index variable in <code>sol</code> is assumed to be temperature, as is true for the lumped capacitance model (see <a href="#LyoPronto.ParamObjRF">ParamObjRF`</a>.</p><p>If there are multiple series of <code>Tf</code> in <code>pdfit</code>, squared error is computed for each separately then summed; likewise for <code>Tvw</code>.</p><p>I&#39;ve considered writing several methods and dispatching on <code>pdfit</code> somehow, which would be cool and might individually be easier to read. But control flow might be harder to document and explain, and this should work just fine.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L186-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.obj_pd-Tuple{Any, Any}" href="#LyoPronto.obj_pd-Tuple{Any, Any}"><code>LyoPronto.obj_pd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obj_pd(fitlog, tpf; tweight, Tvw_weight, badprms, verbose)
</code></pre><p>Calculate the sum of squared error (objective function) for fitting parameters to primary drying data. This directly calls <a href="#LyoPronto.gen_sol_pd-NTuple{4, Any}"><code>gen_sol_pd</code></a>, then <a href="#LyoPronto.obj_expT-Tuple{ODESolution, PrimaryDryFit}"><code>obj_expT</code></a>, so see those docstrings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/paramfits.jl#L146-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.identify_pd_end-Tuple{Any, Any, Any}" href="#LyoPronto.identify_pd_end-Tuple{Any, Any, Any}"><code>LyoPronto.identify_pd_end</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">identify_pd_end(t, pch_pir, kind; window_width, tmin, tmax)
</code></pre><p>Identify the end of primary drying using second derivative of Pirani pressure.</p><p><strong>Arguments</strong></p><ul><li><code>t</code>: time points</li><li><code>pch_pir</code>: Pirani pressure at given times</li><li><code>kind</code>: <code>Val(:der2)</code> for maximum of second derivative, <code>Val(:onoff)</code> for onset and offset.</li><li><code>window_width</code>: Width of the Savitzky-Golay filter window (default: 91)</li><li><code>tmin</code>: Minimum time for analysis (default: 0 hours, unitful)</li><li><code>tmax</code>: Maximum time for analysis (default: Inf hours, unitful)</li></ul><p>If a single argument <code>data</code> is passed instead of <code>t</code> and <code>pch_pir</code>, the time and Pirani pressure are assumed to be  accessible as either <code>data.t</code> and <code>data.pch_pir</code> or <code>data[:t]</code> and <code>data[:pch_pir]</code>.</p><p><strong>Approach</strong></p><p>Use a Savitzky-Golay filter to smooth and take derivatives. For the onset-offset, find linear intersects of tangent at inflection point with maximum and  minimum values of pressure. Those intersects are taken as onset and offset. For the second derivative, identify the maximum of the second derivative.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/cycle_time.jl#L2-L25">source</a></section></article><h2 id="Plot-Recipes"><a class="docs-heading-anchor" href="#Plot-Recipes">Plot Recipes</a><a id="Plot-Recipes-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-Recipes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.cycledataplot" href="#LyoPronto.cycledataplot"><code>LyoPronto.cycledataplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cycledataplot(tablelike, (Tname1, ...), Tsh_name, (p_name1, ...))
cycledataplot!(tablelike, (Tname1, ...), Tsh_name, (p_name1, ...))</code></pre><p>Plot recipe for plotting both temperatures and pressures of a lyophilization cycle.</p><p>This requires at least two subplots, one for temperature and one for pressure. Either call <code>twinx(plot())</code> then <code>cycledataplot!(...)</code>, or give a layout like  <code>cycledataplot(..., layout=(2,1))</code>&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L496-L505">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.cycledataplot!" href="#LyoPronto.cycledataplot!"><code>LyoPronto.cycledataplot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cycledataplot(tablelike, (Tname1, ...), Tsh_name, (p_name1, ...))
cycledataplot!(tablelike, (Tname1, ...), Tsh_name, (p_name1, ...))</code></pre><p>Plot recipe for plotting both temperatures and pressures of a lyophilization cycle.</p><p>This requires at least two subplots, one for temperature and one for pressure. Either call <code>twinx(plot())</code> then <code>cycledataplot!(...)</code>, or give a layout like  <code>cycledataplot(..., layout=(2,1))</code>&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L507">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.exppplot" href="#LyoPronto.exppplot"><code>LyoPronto.exppplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exppplot(t, p1, [p2, ...,], (name1, [name2, ...]))
exppplot!(t, p1, [p2, ...,], (name1, [name2, ...]))</code></pre><p>Plot recipe for plotting pressures of a lyophilization cycle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L471-L476">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.exppplot!" href="#LyoPronto.exppplot!"><code>LyoPronto.exppplot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exppplot(t, p1, [p2, ...,], (name1, [name2, ...]))
exppplot!(t, p1, [p2, ...,], (name1, [name2, ...]))</code></pre><p>Plot recipe for plotting pressures of a lyophilization cycle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L478">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.exptfplot" href="#LyoPronto.exptfplot"><code>LyoPronto.exptfplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exptfplot(time, T1, [T2, ...]; nmarks=0, labsuffix=&quot;, exp.&quot;)
exptfplot!(time, T1, [T2, ...]; nmarks=0, labsuffix=&quot;, exp.&quot;)</code></pre><p>Plot recipe for one or more experimentally measured product temperatures, all at same times. This recipe adds one series for each passed temperature series, with labels defaulting to <code>&quot;T_{fi}&quot;*labsuffix</code>.</p><p><code>nmarks</code> is an integer, indicating how many points to plot with markers, so that the number of markers is reasonable even with many data points. To plot all points (default), pass <code>nmarks=0</code>.</p><p><code>sampmarks=false</code> (default) will only show markers at selected points, while <code>sampmarks=true</code> will put a line through all points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L47-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.exptfplot!" href="#LyoPronto.exptfplot!"><code>LyoPronto.exptfplot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exptfplot(time, T1, [T2, ...]; nmarks=0, labsuffix=&quot;, exp.&quot;)
exptfplot!(time, T1, [T2, ...]; nmarks=0, labsuffix=&quot;, exp.&quot;)</code></pre><p>Plot recipe for one or more experimentally measured product temperatures, all at same times. This recipe adds one series for each passed temperature series, with labels defaulting to <code>&quot;T_{fi}&quot;*labsuffix</code>.</p><p><code>nmarks</code> is an integer, indicating how many points to plot with markers, so that the number of markers is reasonable even with many data points. To plot all points (default), pass <code>nmarks=0</code>.</p><p><code>sampmarks=false</code> (default) will only show markers at selected points, while <code>sampmarks=true</code> will put a line through all points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.exptvwplot" href="#LyoPronto.exptvwplot"><code>LyoPronto.exptvwplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exptvwplot(time, T1, [T2, ...]; skip=1, nmarks=0, labsuffix=&quot;, exp.&quot;)
exptvwplot!(time, T1, [T2, ...]; skip=1, nmarks=0, labsuffix=&quot;, exp.&quot;)</code></pre><p>Plot recipe for a set of experimentally measured vial wall temperatures. This recipe adds one series for each passed temperature series, with labels defaulting to <code>&quot;T_{vwi}&quot;*labsuffix</code>. <code>skip</code> is an integer, indicating how many points to skip at a time, so that  the dotted line looks dotted even with noisy data.</p><p><code>nmarks</code> is an integer, indicating how many points to plot with markers, so that the number of markers is reasonable even with many data points. To plot all points (default), pass <code>nmarks=0</code>.</p><p><code>sampmarks=false</code> (default) will only show markers at selected points, while <code>sampmarks=true</code> will put a line through all points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L99-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.exptvwplot!" href="#LyoPronto.exptvwplot!"><code>LyoPronto.exptvwplot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exptvwplot(time, T1, [T2, ...]; skip=1, nmarks=0, labsuffix=&quot;, exp.&quot;)
exptvwplot!(time, T1, [T2, ...]; skip=1, nmarks=0, labsuffix=&quot;, exp.&quot;)</code></pre><p>Plot recipe for a set of experimentally measured vial wall temperatures. This recipe adds one series for each passed temperature series, with labels defaulting to <code>&quot;T_{vwi}&quot;*labsuffix</code>. <code>skip</code> is an integer, indicating how many points to skip at a time, so that  the dotted line looks dotted even with noisy data.</p><p><code>nmarks</code> is an integer, indicating how many points to plot with markers, so that the number of markers is reasonable even with many data points. To plot all points (default), pass <code>nmarks=0</code>.</p><p><code>sampmarks=false</code> (default) will only show markers at selected points, while <code>sampmarks=true</code> will put a line through all points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.modconvtplot" href="#LyoPronto.modconvtplot"><code>LyoPronto.modconvtplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">modconvtplot(sols; sampmarks=false, labsuffix = &quot;, model&quot;)
modconvtplot!(sols; sampmarks=false, labsuffix = &quot;, model&quot;)</code></pre><p>Plot recipe for one or multiple solutions to the Pikal model, e.g. the output of <a href="#LyoPronto.gen_sol_pd-NTuple{4, Any}"><code>gen_sol_pd</code></a>. This adds a series to the plot for each passed solution, with labels defaulting to <code>&quot;T_{fi}&quot;*labsuffix</code>.</p><p><code>sampmarks=false</code> (default) will only put a line through all points, while <code>sampmarks=true</code> will show markers at selected points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L160-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.modconvtplot!" href="#LyoPronto.modconvtplot!"><code>LyoPronto.modconvtplot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">modconvtplot(sols; sampmarks=false, labsuffix = &quot;, model&quot;)
modconvtplot!(sols; sampmarks=false, labsuffix = &quot;, model&quot;)</code></pre><p>Plot recipe for one or multiple solutions to the Pikal model, e.g. the output of <a href="#LyoPronto.gen_sol_pd-NTuple{4, Any}"><code>gen_sol_pd</code></a>. This adds a series to the plot for each passed solution, with labels defaulting to <code>&quot;T_{fi}&quot;*labsuffix</code>.</p><p><code>sampmarks=false</code> (default) will only put a line through all points, while <code>sampmarks=true</code> will show markers at selected points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.modrftplot" href="#LyoPronto.modrftplot"><code>LyoPronto.modrftplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">modrftplot(sol, labsuffix=&quot;, model&quot;, sampmarks=false, trimend=0)
modrftplot!(sol, labsuffix=&quot;, model&quot;, sampmarks=false, trimend=0)</code></pre><p>Plot recipe for one solution to the lumped capacitance model.</p><p>This adds two series to the plot, with labels defaulting to <code>[&quot;T_f&quot; &quot;T_{vw}&quot;] .* labsuffix</code>. The optional argument <code>trimend</code> controls how many time points to trim from the end (which is helpful if temperature shoots up as mf -&gt; 0).</p><p>Since this is a recipe, any Plots.jl keyword arguments can be passed to modify the plot.</p><p><code>sampmarks=false</code> (default) will only put a line through all points, while <code>sampmarks=true</code> will show markers at selected points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L217-L230">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.modrftplot!" href="#LyoPronto.modrftplot!"><code>LyoPronto.modrftplot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">modrftplot(sol, labsuffix=&quot;, model&quot;, sampmarks=false, trimend=0)
modrftplot!(sol, labsuffix=&quot;, model&quot;, sampmarks=false, trimend=0)</code></pre><p>Plot recipe for one solution to the lumped capacitance model.</p><p>This adds two series to the plot, with labels defaulting to <code>[&quot;T_f&quot; &quot;T_{vw}&quot;] .* labsuffix</code>. The optional argument <code>trimend</code> controls how many time points to trim from the end (which is helpful if temperature shoots up as mf -&gt; 0).</p><p>Since this is a recipe, any Plots.jl keyword arguments can be passed to modify the plot.</p><p><code>sampmarks=false</code> (default) will only put a line through all points, while <code>sampmarks=true</code> will show markers at selected points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.pressurenames-Tuple{String}" href="#LyoPronto.pressurenames-Tuple{String}"><code>LyoPronto.pressurenames</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pressurenames(name)</code></pre><p>Attempt to catch common names or shorthands for Pirani and capacitance manometer, then give back a nice label.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L455-L459">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.qrf_integrate-Tuple{Any, Any}" href="#LyoPronto.qrf_integrate-Tuple{Any, Any}"><code>LyoPronto.qrf_integrate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qrf_integrate(sol, RF_params)</code></pre><p>Compute the integral over time of each heat transfer mode in the lumped capacitance model.</p><p>Returns as a Dict{String, Quantity{...}}, with string keys <code>Qsub, Qshf, Qvwf, QRFf, QRFvw</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L410-L416">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.tendplot" href="#LyoPronto.tendplot"><code>LyoPronto.tendplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tendplot(t_end)
tendplot!(t_end)
tendplot(t_end1, t_end2)
tendplot!(t_end1, t_end2)</code></pre><p>Plot recipe that adds a labeled vertical line to the plot at time <code>t_end</code>.  A default label and styling are applied, but these can be modified by keyword arguments as usual If two time points are passed, a light shading is applied between instead of a vertical line.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L286-L295">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.tendplot!" href="#LyoPronto.tendplot!"><code>LyoPronto.tendplot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tendplot(t_end)
tendplot!(t_end)
tendplot(t_end1, t_end2)
tendplot!(t_end1, t_end2)</code></pre><p>Plot recipe that adds a labeled vertical line to the plot at time <code>t_end</code>.  A default label and styling are applied, but these can be modified by keyword arguments as usual If two time points are passed, a light shading is applied between instead of a vertical line.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/recipes.jl#L297">source</a></section></article><h2 id="Vial-Dimensions"><a class="docs-heading-anchor" href="#Vial-Dimensions">Vial Dimensions</a><a id="Vial-Dimensions-1"></a><a class="docs-heading-anchor-permalink" href="#Vial-Dimensions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.get_vial_mass-Tuple{String}" href="#LyoPronto.get_vial_mass-Tuple{String}"><code>LyoPronto.get_vial_mass</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_vial_mass(vialsize)
</code></pre><p>Return vial mass for given ISO vial size.</p><p>Uses a table from a SCHOTT manual, stored internally in a CSV.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/get_vial_dims.jl#L44-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.get_vial_radii-Tuple{String}" href="#LyoPronto.get_vial_radii-Tuple{String}"><code>LyoPronto.get_vial_radii</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_vial_radii(vialsize)
</code></pre><p>Return inner and outer radius for passed ISO vial size.</p><p>Uses a table from a SCHOTT manual, stored internally in a CSV.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/get_vial_dims.jl#L17-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.get_vial_shape-Tuple{String}" href="#LyoPronto.get_vial_shape-Tuple{String}"><code>LyoPronto.get_vial_shape</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_vial_shape(vialsize::String)</code></pre><p>Return a NamedTuple with a slew of vial dimensions, useful for drawing the shape of the vial with <a href="#LyoPronto.make_outlines-Tuple{Any, Any}"><code>make_outlines</code></a>.</p><p>Uses a table from a SCHOTT manual, stored internally in a CSV.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/get_vial_dims.jl#L57-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.get_vial_thickness-Tuple{String}" href="#LyoPronto.get_vial_thickness-Tuple{String}"><code>LyoPronto.get_vial_thickness</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_vial_thickness(vialsize)
</code></pre><p>Return vial wall thickness for given ISO vial size.</p><p>Uses a table from a SCHOTT manual, stored internally in a CSV.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/get_vial_dims.jl#L31-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.make_outlines-Tuple{Any, Any}" href="#LyoPronto.make_outlines-Tuple{Any, Any}"><code>LyoPronto.make_outlines</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_outlines(dims, Vfill)</code></pre><p>Return a sequence of points (ready to be made into <code>Plots.Shape</code>s for the vial and fill volume, with Unitful dimensions, for given vial dimensions.</p><p>This is a convenience function for making figures illustrating fill depth.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/get_vial_dims.jl#L80-L86">source</a></section></article><h2 id="Model-Equations"><a class="docs-heading-anchor" href="#Model-Equations">Model Equations</a><a id="Model-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Equations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.end_drying_callback" href="#LyoPronto.end_drying_callback"><code>LyoPronto.end_drying_callback</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A callback for use in simulating either the Pikal or RF model.</p><p>Terminates the time integration when <a href="#LyoPronto.end_cond-Tuple{Any, Any, Any}"><code>end_cond</code></a> evaluates to <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/pikal_model.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.lyo_1d_dae_f" href="#LyoPronto.lyo_1d_dae_f"><code>LyoPronto.lyo_1d_dae_f</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lyo_1d_dae_f = ODEFunction(lyo_1d_dae!, mass_matrix=lyo_1d_mm)</code></pre><p>Compute the right hand side function for the Pikal model.</p><p>The DAE system which is the Pikal model (1 ODE, one nonlinear algebraic equation for pseudosteady conditions) is here treated as a constant-mass-matrix implicit ODE system. The implementation is in <a href="#LyoPronto.lyo_1d_dae!-NTuple{4, Any}"><code>lyo_1d_dae!</code></a></p><p>The initial conditions <code>u0 = [h_f, Tf]</code> should be unitless, but are internally assigned to be in <code>[cm, K]</code>. The unitless time is taken to be in hours, so derivatives are given in unitless <code>[cm/hr, K/hr]</code>.</p><p><code>params</code> is a <code>ParamObjPikal</code>, which can be constructed with the following form (helping with readability):</p><pre><code class="language-julia hljs">params = ParamObjPikal((
    (Rp, hf0, csolid, ρsolution),
    (Kshf, Av, Ap),
    (pch, Tsh) ,
))</code></pre><p>where those listed following are callables returning <code>Quantity</code>s, and the rest are <code>Quantity</code>s. See <a href="#LyoPronto.RpFormFit"><code>RpFormFit</code></a> and <a href="#LyoPronto.RampedVariable"><code>RampedVariable</code></a> for convenience types that can help with the callables.</p><ul><li><code>Rp(x)</code> with <code>x</code> a length returns mass transfer resistance (as a Unitful quantity)</li><li><code>Kshf(p)</code> with <code>p</code> a pressure returns heat transfer coefficient (as a Unitful quantity).</li><li><code>Tsh(t)</code>, <code>pch(t)</code> return shelf temperature and chamber pressure respectively at time <code>t</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/pikal_model.jl#L87-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.ParamObjPikal" href="#LyoPronto.ParamObjPikal"><code>LyoPronto.ParamObjPikal</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ParamObjPikal{__T_Rp, __T_hf0, __T_csolid, __T_ρsolution, __T_Kshf, __T_Av, __T_Ap, __T_pch, __T_Tsh} &lt;: LyoPronto.ParamObj</code></pre><p>The <code>ParamObjPikal</code> type is a container for the parameters used in the Pikal model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/pikal_model.jl#L135-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.ParamObjRF" href="#LyoPronto.ParamObjRF"><code>LyoPronto.ParamObjRF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ParamObjRF{__T_Rp, __T_hf0, __T_csolid, __T_ρsolution, __T_Kshf, __T_Av, __T_Ap, __T_pch, __T_Tsh, __T_P_per_vial, __T_mf0, __T_cpf, __T_mv, __T_cpv, __T_Arad, __T_f_RF, __T_eppf, __T_eppvw, __T_Kvwf, __T_Bf, __T_Bvw, __T_alpha} &lt;: LyoPronto.ParamObj</code></pre><p>The <code>ParamObjRF</code> type is a container for the parameters used in the RF model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/rf_lumcap_model.jl#L161-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.calc_md_Q-Tuple{Any, Any, Any}" href="#LyoPronto.calc_md_Q-Tuple{Any, Any, Any}"><code>LyoPronto.calc_md_Q</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_md_Q(u, po, t)
</code></pre><p>With the Pikal model, compute the mass flow at <code>u=[hf, Tf]</code>, time <code>t</code>, and conditions <code>po</code>. Ideally <code>po</code> should be a <code>ParamObjPikal</code>.</p><p>This gets used inside the DAE solve, but for consistency is provided separately so to avoid the risk of making unit mistakes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/pikal_model.jl#L18-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.end_cond-Tuple{Any, Any, Any}" href="#LyoPronto.end_cond-Tuple{Any, Any, Any}"><code>LyoPronto.end_cond</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">end_cond(u, t, integ)</code></pre><p>Compute the end condition for primary drying (that <code>mf</code> or <code>hf</code> approaches zero).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/pikal_model.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.lumped_cap_rf!" href="#LyoPronto.lumped_cap_rf!"><code>LyoPronto.lumped_cap_rf!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lumped_cap_rf!(du, u, params, tn)
lumped_cap_rf!(du, u, params, tn, qret)
</code></pre><p>Compute the right-hand-side function for the ODEs making up the lumped-capacitance microwave-assisted model.</p><p>The optional argument <code>qret</code> defaults to <code>Val(false)</code>; if set to <code>Val(true)</code>, the function returns <code>[Q_sub, Q_shf, Q_vwf, Q_RF_f, Q_RF_vw, Q_shw]</code> with <code>Q_...</code> as Unitful quantities in watts.  The extra results are helpful in investigating the significance of the various heat transfer  modes, but are not necessary in the ODE integration.</p><p><code>du</code> refers to <code>[dmf/dt, dTf/dt, dTvw/dt]</code>, with <code>u = [mf, Tf, Tvw]</code>. <code>u</code> is taken without units but assumed to have the units of <code>[g, K, K]</code> (which is internally added). <code>tn</code> is assumed to be in hours (internally added), so <code>dudt</code> is returned with assumed units <code>[g/hr, K/hr, K/hr]</code> to be consistent.</p><p>It is recommended to use the <code>ParamObjRF</code> type to hold the parameters, since it allows some more convenient access to the parameters, but they can be given in the form of a  tuple-of-tuples:</p><pre><code class="language-julia hljs">params = (   
    (Rp, hf0, cSolid, ρsolution),
    (Kshf_f, Av, Ap),
    (pch, Tsh, P_per_vial),
    (mf0, cpf, mv, cpv, Arad),
    (f_RF, eppf, eppvw),
    (Kvwf, Bf, Bvw, alpha),
)</code></pre><p>This tuple-of-tuples structure is also used in an extra constructor for the <code>ParamObjRF</code> type.</p><p>These should all be Unitful quantities with appropriate dimensions, with some exceptions which are callables returning quantities. See <a href="#LyoPronto.RpFormFit"><code>RpFormFit</code></a> and <a href="#LyoPronto.RampedVariable"><code>RampedVariable</code></a> for convenience types that can help with these cases.</p><ul><li><p><code>Rp(x)</code> with <code>x</code> a length returns mass transfer resistance (as a Unitful quantity)</p></li><li><p><code>Kshf_f(p)</code> with <code>p</code> a pressure returns heat transfer coefficient (as a Unitful quantity).</p></li><li><p><code>Tsh(t)</code>, <code>pch(t)</code>, <code>P_per_vial(t)</code> return shelf temperature, chamber pressure, and microwave power respectively at time <code>t</code>.</p></li><li><p><code>Arad</code> and <code>alpha</code> are used only in prior versions of the model, and can be left out.</p></li></ul><p>This is my updated version of the model. LC3: Q_shw evaluated with Kshf; shape factor included; α=0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/rf_lumcap_model.jl#L20-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.lyo_1d_dae!-NTuple{4, Any}" href="#LyoPronto.lyo_1d_dae!-NTuple{4, Any}"><code>LyoPronto.lyo_1d_dae!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lyo_1d_dae!(du, u, params, t)</code></pre><p>Internal implementation of the Pikal model. See <a href="#LyoPronto.lyo_1d_dae_f"><code>lyo_1d_dae_f</code></a> for the wrapped version, which is more fully documented.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/pikal_model.jl#L54-L59">source</a></section></article><h2 id="Physical-Properties"><a class="docs-heading-anchor" href="#Physical-Properties">Physical Properties</a><a id="Physical-Properties-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Properties" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.Mw" href="#LyoPronto.Mw"><code>LyoPronto.Mw</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Molecular weight of water</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.cp_gl" href="#LyoPronto.cp_gl"><code>LyoPronto.cp_gl</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Glass heat capacity Rough estimate from Bansal and Doremus 1985, &quot;Handbook of Glass Properties&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L49-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.cp_ice" href="#LyoPronto.cp_ice"><code>LyoPronto.cp_ice</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Ice heat capacity IAPWS for ice: use triple point value for simplicity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L31-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.e_0" href="#LyoPronto.e_0"><code>LyoPronto.e_0</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Permittivity of free space</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.k_gl" href="#LyoPronto.k_gl"><code>LyoPronto.k_gl</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Glass thermal conductivity From Bansal and Doremus 1985, rough estimate based an a sodium borosilicate glass</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L43-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.k_ice" href="#LyoPronto.k_ice"><code>LyoPronto.k_ice</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Thermal conductivity of ice From Slack, 1980 200K : .032 W/cmK 250K : .024 W/cmK 273K : .0214 W/cmK</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L22-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.k_sucrose" href="#LyoPronto.k_sucrose"><code>LyoPronto.k_sucrose</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Thermal conductivity of sucrose, Caster grade powder From McCarthy and Fabre, 1989 book chapter</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L68-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.rho_ice" href="#LyoPronto.rho_ice"><code>LyoPronto.rho_ice</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Density of ice at triple point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L37-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.ΔHsub" href="#LyoPronto.ΔHsub"><code>LyoPronto.ΔHsub</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Heat of sublimation of ice Approximate: coresponds to 254K or 225K From Feistel and Wagner, 2006</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.εpp_gl" href="#LyoPronto.εpp_gl"><code>LyoPronto.εpp_gl</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Dielectric loss coefficient of borosilicate glass, per Schott&#39;s testing</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.μ_vap" href="#LyoPronto.μ_vap"><code>LyoPronto.μ_vap</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Water vapor viscosity in dilute limit</p><p>From Hellmann and Vogel, 2015 250K: 8.054 μPa<em>s 260K: 8.383 μPa</em>s 270K: 8.714 μPa*s</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L80-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.ρ_gl" href="#LyoPronto.ρ_gl"><code>LyoPronto.ρ_gl</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Glass density SCHOTT measurement, posted online</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L55-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.ρ_sucrose" href="#LyoPronto.ρ_sucrose"><code>LyoPronto.ρ_sucrose</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Density of sucrose, Caster grade powder From McCarthy and Fabre, 1989 book chapter</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L74-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.σ" href="#LyoPronto.σ"><code>LyoPronto.σ</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Stefan-Boltzmann Constant</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.calc_Tsub-Tuple{Q} where Q&lt;:(Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U})" href="#LyoPronto.calc_Tsub-Tuple{Q} where Q&lt;:(Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U})"><code>LyoPronto.calc_Tsub</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Using the same Arrhenius fit as <code>calc_psub</code>, compute the sublimation temperature at a given pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L105-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.calc_psub-Tuple{Any}" href="#LyoPronto.calc_psub-Tuple{Any}"><code>LyoPronto.calc_psub</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_psub(T) 
calc_psub(T::Q) where Q&lt;:Quantity</code></pre><p>Compute pressure (in Pascals) of sublimation at temperature <code>T</code> in Kelvin.</p><p>This is essentially an Arrhenius fit, where we compute: <code>psub = pref * exp(-ΔHsub*Mw/R/T)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L93-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.Dielectric" href="#LyoPronto.Dielectric"><code>LyoPronto.Dielectric</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Single-purpose module for computing the dielectric loss coefficient of ice, as a function of temperature and frequency. This module exports a function <code>ϵppf(T, f)</code> for doing so. (Set as a separate module just to keep namespaces clean.) This code is a nearly-direct implementation of the correlation, Eqs. 3-6 presented in: Takeshi Matsuoka, Shuji Fujita, Shinji Mae; Effect of temperature on dielectric properties of ice in the range 5–39 GHz. J. Appl. Phys. 15 November 1996; 80 (10): 5884–5890. https://doi.org/10.1063/1.363582</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L111-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LyoPronto.Dielectric.ϵppf" href="#LyoPronto.Dielectric.ϵppf"><code>LyoPronto.Dielectric.ϵppf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ϵppf(T, f)</code></pre><p>Compute the dielectric loss of ice as a function of temperature and frequency. Expects temperature in Kelvin and frequency in Hz, with Unitful units.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/LyoHUB/LyoPronto.jl/blob/e67f586316846fea4bfe672f931202ec8e9f350c/src/physical_properties.jl#L155-L160">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../generated/all_recipes/">« Plot recipes</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Tuesday 28 October 2025 14:06">Tuesday 28 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
